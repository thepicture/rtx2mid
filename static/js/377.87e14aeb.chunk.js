"use strict";(self.webpackChunkrtx2mid=self.webpackChunkrtx2mid||[]).push([[377],{7252:function(t,n,e){e.d(n,{Bx:function(){return m},Dv:function(){return d},RE:function(){return i},RG:function(){return u},W$:function(){return v},bG:function(){return a},lK:function(){return s},nr:function(){return h},sH:function(){return l},w7:function(){return c},y4:function(){return p},zu:function(){return f}});var r=e(3144),o=e(5671),i=(0,r.Z)((function t(){(0,o.Z)(this,t)}));i.HEADER=0,i.NOTE=1,i.SCALE=2,i.STYLE=3,i.TEMPO=4,i.VOLUME=5;var a=(0,r.Z)((function t(){(0,o.Z)(this,t)}));a.PAUSE=-1;var c={c:0,"c#":1,d:2,"d#":3,e:4,f:5,"f#":6,g:7,"g#":8,a:9,"a#":10,h:11,p:0},u={"00000":25,"00001":28,"00010":31,"00011":35,"00100":40,"00101":45,"00110":50,"00111":56,"01000":63,"01001":70,"01010":80,"01011":90,"01100":100,"01101":112,"01110":125,"01111":140,1e4:160,10001:180,10010:200,10011:225,10100:250,10101:285,10110:320,10111:355,11e3:400,11001:450,11010:500,11011:565,11100:635,11101:715,11110:800,11111:900},s={"0000":"p","0001":"c","0010":"c#","0011":"d","0100":"d#","0101":"e","0110":"f","0111":"f#",1e3:"g",1001:"g#",1010:"a",1011:"a#",1100:"h"},l={"00":1,"01":2,10:3,11:4},d={"000":"1","001":"2","010":"4","011":"8",100:"16",101:"32"},f={"00":"no special duration","01":"dotted note",10:"double dotted note",11:"2/3 length"},h=function(t){for(var n=[],e=0;e<t.length;e+=2)n.push(parseInt(t.substring(e,e+2),16));return n},p=/.{2}/g,v=6e7,m={type:"audio/midi"}},8067:function(t,n,e){e.d(n,{p:function(){return a}});var r=e(5671),o=e(3144),i=e(7252),a=function(){function t(){(0,r.Z)(this,t),this.patternHeader=void 0,this.commandLength=void 0,this.ringingToneProgramming=void 0,this.sound=void 0,this.basicSongType=void 0,this.songSequenceLength=void 0,this.patternId=void 0,this.loopValue=void 0,this.patternSpecifier=void 0}return(0,o.Z)(t,[{key:"convertToRtttl",value:function(t){var n=0;if(this.commandLength=t.slice(n,n+8),n+=8,this.ringingToneProgramming=t.slice(n,n+8),n+=8,this.sound=t.slice(n,n+7),n+=7,this.basicSongType=t.slice(n,n+3),"001"!==this.basicSongType)throw new Error("expected basic song type 001, got ".concat(this.basicSongType));n+=3;var e=parseInt(t.slice(n,n+4),2);n+=4;var r=t.slice(n,n+8*e).match(/.{8}/g).map((function(t){return String.fromCharCode(parseInt(t,2))})).join("");n+=8*e,this.songSequenceLength=t.slice(n,n+8),n+=8,this.patternHeader=t.slice(n,n+3),n+=3,this.patternId=t.slice(n,n+2),n+=2,this.loopValue=Boolean(parseInt(t.slice(n,n+4),2)),n+=4,this.patternSpecifier=t.slice(n,n+8);for(var o=[],a=n+=8;a<t.length&&t.slice(a,a+7)!=="0".repeat(7);){var c=parseInt(t.slice(a,a+3),2);a+=3,c===i.RE.NOTE?(o.push({id:c,note:i.lK[t.slice(a,a+4)],duration:i.Dv[t.slice(a+4,a+4+3)],durationSpecifier:i.zu[t.slice(a+4+3,a+4+3+2)]}),a+=9):c===i.RE.SCALE?(o.push({id:c,scale:i.sH[t.slice(a,a+2)]}),a+=2):c===i.RE.TEMPO?(o.push({id:c,tempo:i.RG[t.slice(a,a+5)]}),a+=5):c===i.RE.STYLE?a+=2:c===i.RE.VOLUME&&(a+=4)}for(var u="".concat(r,":d=8,o=4,b=").concat(o.find((function(t){return"undefined"!==typeof t.tempo})).tempo||63,":"),s=[],l=1,d=0,f=o;d<f.length;d++){var h=f[d];h.id===i.RE.NOTE?s.push("".concat(h.duration).concat(h.note).concat("p"===h.note?"":l+3).concat("dotted note"===h.durationSpecifier?".":"")):h.id===i.RE.SCALE&&(l=h.scale)}return u+s.join(",")}},{key:"digestToFile",value:function(t){return new File([new Uint8Array(t.split("").map((function(t){return t.charCodeAt(0)})))],this.generateFilename(),i.Bx)}},{key:"generateFilename",value:function(){return"rtx2rtttl_".concat(Date.now().toString(),".rtttl")}}]),t}()},5377:function(t,n,e){e.r(n),e.d(n,{default:function(){return k}});var r=e(1413),o=e(4165),i=e(5861),a=e(9439),c=e(2791),u=e(6776),s=e(3403),l=e(5794),d=e(7721),f=e(7629),h=e(8067),p=e(7762),v=e(3433),m=e(5671),g=e(3144),Z=e(7252),y=function(){function t(){(0,m.Z)(this,t)}return(0,g.Z)(t,[{key:"convertNumberToDeltaTime",value:function(t){for(var n=127&t;t>>=7;)n<<=8,n|=127&t|128;for(var e=[];e.push(255&n),128&n;)n>>=8;return[].concat((0,v.Z)(new Array(4-e.length).fill(0)),e)}}]),t}(),x=/(\d+)([a-z#]+)(\d+)?/,S=function(){function t(){(0,m.Z)(this,t)}return(0,g.Z)(t,[{key:"convertToComponents",value:function(t){var n=this.extractNoteComponents(t),e=(0,a.Z)(n,3),r=e[0],o=e[1],i=e[2],c=void 0===i?4:i,u=t.includes(".");return this.isPause(t)?{noteCode:Z.bG.PAUSE,duration:Number(r),velocity:0,shouldUseDotNotation:u}:{noteCode:Z.w7[o]+12*(Number(c)+1),duration:Number(r),velocity:127,shouldUseDotNotation:u}}},{key:"extractNoteComponents",value:function(t){return t.match(x).slice(1)}},{key:"isPause",value:function(t){return t.includes("p")}}]),t}(),w=function(){function t(){(0,m.Z)(this,t)}return(0,g.Z)(t,[{key:"convertDurationToTicks",value:function(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Math.round(Z.W$/t/n*(1/e));return r?o+o/2:o}}]),t}(),T=/b=(\d+)/,b=function(){function t(){(0,m.Z)(this,t)}return(0,g.Z)(t,[{key:"convertRtttlToMidiFile",value:function(t){console.log(t);var n,e=t.split(":"),r=(0,a.Z)(e,3),o=r[0],i=r[1],c=r[2],u=[0,255,3,o.length],s=Array.from(o).map((function(t){return t.charCodeAt(0)})),l=Number(i.match(T)[1]),d=Math.floor(Z.W$/l*4).toString(16).padStart(6,"0").match(Z.y4).map((function(t){return parseInt(t,16)})),f=[].concat(u,(0,v.Z)(s),[0,255,2,0],[0,255,81,3],[].concat((0,v.Z)(new Array(3-d.length).fill(0)),(0,v.Z)(d)),[0,192,80]),h=new S,m=new y,g=new w,x=(0,p.Z)(c.split(","));try{for(x.s();!(n=x.n()).done;){var b=n.value,E=h.convertToComponents(b),C=E.noteCode,k=E.duration,R=E.velocity,N=E.shouldUseDotNotation,j=g.convertDurationToTicks(l,960,k,N),A=m.convertNumberToDeltaTime(j);f.push.apply(f,[0].concat([144,C,R],(0,v.Z)(A),[128,C,0]))}}catch(U){x.e(U)}finally{x.f()}f.push(0,255,47,0);var L=(0,Z.nr)(f.length.toString(16).padStart(4,"0"));return new File([new Uint8Array([].concat([77,84,104,100],[0,0,0,6],[0,0],[0,1],[1,224],[77,84,114,107],[].concat((0,v.Z)(new Array(4-L.length).fill(0)),(0,v.Z)(L)),(0,v.Z)(f)))],this.generateFilename(),Z.Bx)}},{key:"generateFilename",value:function(){return"rtx2midi_".concat(Date.now().toString(),".mid")}}]),t}(),E=e(184),C={labelCol:{span:6},wrapperCol:{span:14}},k=function(){var t=(0,c.useState)(!1),n=(0,a.Z)(t,2),e=n[0],p=n[1],v=(0,c.useState)(""),m=(0,a.Z)(v,2),g=m[0],Z=m[1],y=function(t){var n=document.createElement("a"),e=URL.createObjectURL(t);n.download=t.name,n.href=e,n.click(),requestAnimationFrame((function(){return URL.revokeObjectURL(e)}))},x=function(){var t=(0,i.Z)((0,o.Z)().mark((function t(n){var e,r,i,a,c,u;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Uint8Array,t.next=3,n.arrayBuffer();case 3:return t.t1=t.sent,e=new t.t0(t.t1),r=Array.from(e).map((function(t){return t.toString(2).padStart(8,"0")})).join(""),i=new h.p,a=i.convertToRtttl(r),c=new b,u=c.convertRtttlToMidiFile(a),t.abrupt("return",u);case 11:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),S=function(){var t=(0,i.Z)((0,o.Z)().mark((function t(n){var e;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p(!1),t.prev=1,t.next=4,x(n);case 4:e=t.sent,y(e),Z("Conversion successful!"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),Z("File is neither not a .rtl nor .mid that conforms to Nokia Ringtone Format");case 12:p(!0);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(n){return t.apply(this,arguments)}}();return(0,E.jsx)(f._,{children:(0,E.jsx)(s.Z,{content:g,title:"Result",open:e,children:(0,E.jsx)(l.Z,(0,r.Z)((0,r.Z)({name:"convert-rtx"},C),{},{style:{maxWidth:600},children:(0,E.jsx)(l.Z.Item,{label:"Convert",children:(0,E.jsx)(l.Z.Item,{name:"dragger",valuePropName:"fileList",noStyle:!0,getValueFromEvent:function(t){var n=t.file;S(n)},children:(0,E.jsxs)(d.Z.Dragger,{name:"files",maxCount:1,beforeUpload:function(){return!1},children:[(0,E.jsx)("p",{className:"ant-upload-drag-icon",children:(0,E.jsx)(u.Z,{})}),(0,E.jsx)("p",{className:"ant-upload-text",children:"Select a melody to convert"}),(0,E.jsx)("p",{className:"ant-upload-hint",children:"Should be .rtl or .mid"})]})})})}))})})}},7629:function(t,n,e){e.d(n,{_:function(){return a}});var r=e(9205),o=e(3099),i=e(184),a=function(t){var n=t.children;return(0,i.jsx)(r.Z,{title:"Conversion Menu",children:(0,i.jsx)(o.Z,{direction:"horizontal",style:{width:"100%",justifyContent:"center"},children:n})})}}}]);
//# sourceMappingURL=377.87e14aeb.chunk.js.map